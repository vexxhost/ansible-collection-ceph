# Copyright (c) 2025 VEXXHOST, Inc.
# SPDX-License-Identifier: Apache-2.0

- name: Deploy Ceph monitors & managers
  hosts: "{{ ceph_control_plane_group | default('controllers') }}"
  become: true
  roles:
    - role: mon
      tags:
        - ceph-mon
    - role: mgr
      tags:
        - ceph-mgr
  environment:
    CEPH_CONTAINER_IMAGE: "{{ cephadm_image | default('quay.io/ceph/ceph:v' + (ceph_version | default('18.2.1'))) }}"
    CEPH_CONTAINER_BINARY: docker

- name: Deploy Ceph OSDs
  hosts: "{{ ceph_osd_group | default('cephs') }}"
  become: true
  roles:
    - role: osd
      tags:
        - ceph-osd
  environment:
    CEPH_CONTAINER_IMAGE: "{{ cephadm_image | default('quay.io/ceph/ceph:v' + (ceph_version | default('18.2.1'))) }}"
    CEPH_CONTAINER_BINARY: docker

- name: Configure Ceph settings
  hosts: "{{ ceph_control_plane_group | default('controllers') }}"
  become: true
  roles:
    - role: ceph_settings
      tags:
        - ceph-settings
  environment:
    CEPH_CONTAINER_IMAGE: "{{ cephadm_image | default('quay.io/ceph/ceph:v' + (ceph_version | default('18.2.1'))) }}"
    CEPH_CONTAINER_BINARY: docker
